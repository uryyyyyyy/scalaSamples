
４ 例外処理

型安全に例外を扱いたい。
非検査例外はチェックが漏れる可能性がある。
そもそもチェック不要な、修復不可能な例外に使うべし。

検査例外は一応コンパイラで強制できるが、mapなどの高階関数と相性が悪い。
呼び出し側が事前に関数の例外を知ってないといけない。組み合わせにくい

回復可能な例外（≒検査例外）はそれ用の方を作る。
回復不可能な例外（≒OoME, RuntimeException）のみ例外を用いる。

## Option 

`B>:A` AはBの部分型。javaで言うと、AはBを継承している。

相加平均はmeanで、もっと広い平均はaverageらしい。

例外が一意に決まるケース
（例：除算で割る数が０・平均を求めるはずが要素が０だった etc）

この場合にデフォルト値を渡すという対応もあるが、
こういうケースを検知したら途中で処理を中断したくなるケースもあると思う。
デフォルト値なら、という分岐もイマイチなので、
型で定義したい。

## Either

optionは表現力が足りない。
標準ライブラリの一部など、例外が誰から見ても一意で、
特に気にしないでいい時になら使えそうだが、それ以外ならEitherが無難かと。

例えばdaoでfindByIdとかをOptionで包んで返すケースがあるけど、
このメソッドは
・ネットワークエラー
・DB側のトラブル
・sqlの書き間違い
・データが存在しない
など複数の例外パターンが存在する。
このときOptionだけだと上記４種の区別がつかなくなってしまう。
（それでいい場合もあるが、それはLogicに依存するためDaoではそこまで意識したくない。）
IO系はエラーの原因が一意に決まらないことが多そう。